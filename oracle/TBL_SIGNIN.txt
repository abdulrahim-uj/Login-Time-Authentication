ALTER TABLE SCOTT.TBL_SIGNIN
 DROP PRIMARY KEY CASCADE;
DROP TABLE SCOTT.TBL_SIGNIN CASCADE CONSTRAINTS;

CREATE TABLE SCOTT.TBL_SIGNIN
(
  UNAME            VARCHAR2(26 BYTE)            NOT NULL,
  PWD              VARCHAR2(26 BYTE)            NOT NULL,
  TYPE             NUMBER(38)                   NOT NULL,
  TABLE_ID         NUMBER(38)                   NOT NULL,
  GSA_ID           VARCHAR2(15 BYTE)            NOT NULL,
  SIGNUP_TABLE_ID  NUMBER(38)                   NOT NULL,
  SIGNAL           VARCHAR2(7 BYTE)             NOT NULL
)
TABLESPACE USERS
PCTUSED    0
PCTFREE    10
INITRANS   1
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
LOGGING 
NOCOMPRESS 
NOCACHE
NOPARALLEL
MONITORING;


CREATE UNIQUE INDEX SCOTT.TBL_SIGNIN_PK ON SCOTT.TBL_SIGNIN
(UNAME, PWD)
LOGGING
TABLESPACE USERS
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
           )
NOPARALLEL;


CREATE OR REPLACE TRIGGER SCOTT.SIGNI_ID
BEFORE INSERT
ON SCOTT.TBL_SIGNIN 
REFERENCING NEW AS NEW OLD AS OLD
FOR EACH ROW
BEGIN
SELECT SIGNIN_SEQ.NEXTVAL
INTO :NEW.TABLE_ID
FROM DUAL;
END;
/


ALTER TABLE SCOTT.TBL_SIGNIN ADD (
  CONSTRAINT TBL_SIGNIN_PK
 PRIMARY KEY
 (UNAME, PWD)
    USING INDEX 
    TABLESPACE USERS
    PCTFREE    10
    INITRANS   2
    MAXTRANS   255
    STORAGE    (
                INITIAL          64K
                MINEXTENTS       1
                MAXEXTENTS       UNLIMITED
                PCTINCREASE      0
               ));

ALTER TABLE SCOTT.TBL_SIGNIN ADD (
  CONSTRAINT TBL_SIGNIN_R03 
 FOREIGN KEY (SIGNUP_TABLE_ID) 
 REFERENCES SCOTT.TBL_SIGNUP (TABLE_ID),
  CONSTRAINT TBL_SIGNIN_R02 
 FOREIGN KEY (GSA_ID) 
 REFERENCES SCOTT.TBL_GSA_ID_GENERATORE (GSA_ID));
